{% extends "base.html" %}

{% block title %}{{ 'Editar' if product else 'Adicionar' }} Produto - Telmoz{% endblock %}

{% block content %}
<div class="container admin-page">
    <h1>{{ 'Editar' if product else 'Adicionar' }} Produto</h1>

    <form method="POST">
        <div class="form-group">
            <label for="name">Nome do Produto</label>
            <input type="text" id="name" name="name" 
                   value="{{ product.name if product else '' }}" 
                   required placeholder="Nome do produto">
        </div>
        <div class="form-group">
            <label for="description">Descrição</label>
            <textarea id="description" name="description" placeholder="Descrição do produto">{{ product.description if product else '' }}</textarea>
        </div>
        <div class="form-group">
            <label for="price">Preço (MT - Metical)</label>
            <input type="number" id="price" name="price" step="0.01" min="0"
                   value="{{ "%.2f"|format(product.price) if product else '' }}" 
                   required placeholder="0.00">
        </div>
        <div class="form-group">
            <label for="discount_percent">Desconto (%)</label>
            <input type="number" id="discount_percent" name="discount_percent" step="0.1" min="0" max="100"
                   value="{{ "%.1f"|format(product.discount_percent) if product and product.discount_percent else '0' }}" 
                   placeholder="0">
            <small style="color: var(--text-muted);">Ex: 10 para 10% de desconto</small>
        </div>
        <div class="form-group">
            <label for="quantity">Quantidade em stock</label>
            <input type="number" id="quantity" name="quantity" min="0"
                   value="{{ product.quantity if product else 0 }}" 
                   placeholder="0">
        </div>
        <div class="form-group">
            <label for="category_id">Categoria</label>
            <select id="category_id" name="category_id" required>
                <option value="">Selecione uma categoria</option>
                {% for cat in categories %}
                <option value="{{ cat.id }}" {{ 'selected' if product and product.category_id == cat.id else '' }}>
                    {{ cat.name }}
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="image_url">URL da Imagem</label>
            <input type="url" id="image_url" name="image_url" 
                   value="{{ product.image_url if product else '' }}" 
                   placeholder="https://exemplo.com/imagem.jpg">
        </div>
        <div class="form-group">
            <label for="whatsapp_message">Mensagem WhatsApp (opcional)</label>
            <textarea id="whatsapp_message" name="whatsapp_message" placeholder="Mensagem personalizada enviada ao clicar em Comprar">{{ product.whatsapp_message if product else '' }}</textarea>
        </div>
        <div class="admin-actions">
            <button type="submit" class="btn btn-primary">Guardar</button>
            <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
